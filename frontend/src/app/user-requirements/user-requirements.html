<div class="page-shell">

  <div class="page-content-wrapper py-4">
    <div class="container-fluid px-4">

      <!-- HEADER -->
      <div class="premium-header d-flex justify-content-between mb-4">
        <div class="d-flex gap-3">
          <div class="brand-pill">SP</div>
          <div>
            <h4 class="mb-0">User Requirements</h4>
            <small>Enter requirements to generate quotation</small>
          </div>
        </div>

        <button class="btn btn-outline-primary" (click)="onback()">
          ← Dashboard
        </button>
      </div>

      <!-- ERROR -->
      <div *ngIf="errorMsg" class="alert alert-danger">
        {{ errorMsg }}
      </div>

      <div class="row g-4">

        <!-- LEFT FORM -->
        <div class="col-lg-6">
          <div class="card p-4">

            <form [formGroup]="form">

              <div class="mb-3">
                <label>Total Cameras</label>
                <input type="number" class="form-control"
                       formControlName="cammera">
              </div>

              <div class="mb-3">
                <label>Storage Days</label>
                <input type="number" class="form-control"
                       formControlName="storage_days">
              </div>

              <div class="mb-3">
                <label>AI Enabled Cameras</label>
                <input type="number" class="form-control"
                       formControlName="aiEnabledCam">
                <small *ngIf="aiCamMoreThanTotal" class="text-danger">
                  AI cameras must be ≤ total cameras
                </small>
              </div>

              <!-- AI FEATURES -->
              <div class="mb-4">
                <label>AI Features</label>

                <div *ngFor="let ai of aiFeatures" class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    [checked]="form.value.ai_features.includes(ai.id)"
                    (change)="onToggleFeature(ai.id, $event)"
                  />
                  <label class="form-check-label">
                    {{ ai.AI_feature }} (₹{{ ai.costing }})
                  </label>
                </div>
              </div>

              <div class="d-flex justify-content-end gap-2">
                <button type="button"
                        class="btn btn-secondary"
                        (click)="clearQuotation()">
                  Clear
                </button>

                <button type="button"
                        class="btn btn-primary"
                        [disabled]="loading"
                        (click)="calculateCost()">
                  {{ loading ? 'Calculating...' : 'Calculate the Compute and storage requirements' }}
                </button>
              </div>

            </form>
          </div>
        </div>

        <!-- RIGHT RESULT -->
        <div class="col-lg-6">
          <div *ngIf="costCalculated && requirements" class="card p-4">

            <h5>Storage & Compute Requirements</h5>

            <table class="table table-bordered">
              <tr>
                <td>Total Cameras</td>
                <td class="text-end">{{ requirements.cammera }}</td>
              </tr>
  <tr>
  <td>Total Storage</td>
  <td class="text-end">
    {{ storageInTB | number:'1.2-2' }} TB
  </td>
</tr>

              <tr>
                <td>CPU Cores</td>
                <td class="text-end">{{ requirements.cpuCores_required }} cores</td>
              </tr>
              <tr>
                <td>RAM</td>
                <td class="text-end">{{ requirements.ram_required }} GB</td>
              </tr>
              <tr>
                <td>GPU VRAM</td>
                <td class="text-end">{{ requirements.vram_required }} GB</td>
              </tr>
  

            </table>

            <div class="text-end">
              <button class="btn btn-success"
                      (click)="goToQuotationForm()">
                Generate Quotation
              </button>
            </div>

          </div>
        </div>

      </div>
    </div>
  </div>
</div>
